openapi: 3.0.0
info:
  title: oofc-core
  description: |-
    Opus Open Client - Núcleo de gestión de consentimientos

    # Iniciación de Transacción de Pagos Automáticos

    Para más información sobre el flujo de creación de consentimiento, consulte la documentación de la Plataforma Opus Open Finance.
  version: 1.0.0
tags:
  - name: Opus Open Finance
    description: |-
      Endpoints de gestión de consentimientos
  - name: Pagamento Automático
    description: |-
      Endpoints de iniciación de pago relacionados al consentimiento. Los modelos de datos esperados y devueltos son los mismos definidos por la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos)).
  - name: Deeplinks
    description: |-
      Endpoints para obtener configuraciones de iOS Universal Links y Android App Links para que la aplicación de la institución receptora pueda interceptar URLs.
servers:
  - url: https://open-finance-core.instituicao.com.br
paths:
  /.well-known/assetlinks.json:
    get:
      tags:
        - Deeplinks
      operationId: oofcDeeplinksGetAssetLinks
      description: Método para obtener el contenido del archivo assetlinks.json
      summary: Obtener archivo de configuración Android App Links
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AssetLinks"
  /.well-known/apple-app-site-association:
    get:
      tags:
        - Deeplinks
      operationId: oofcDeeplinksGetAppleAppSiteAssociation
      description: Método para obtener el contenido del archivo apple-app-site-association
      summary: Obtener archivo de configuración Apple App Site Association
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppleAppSiteAssociation"
  /opus-open-finance/automatic-payments/v1/recurring-consents:
    post:
      tags:
        - Opus Open Finance
      operationId: automaticPaymentsPostRecurringConsents
      description: Método para crear un consentimiento de larga duración. Devuelve un `recurringConsentId` en el estado AWAITING_AUTHORISATION.
      summary: Crea un consentimiento para transacciones de pagos.
      externalDocs:
        description: Open Finance - API Payment Initiation
        url: https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateRecurringConsentRequest"
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "201":
          description: Consentimiento de pago creado con éxito.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateRecurringConsentResponse"
        "400":
          description: Error enviado por la institución detentora de la cuenta, siguiendo el estándar definido por BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Error enviado por la institución detentora de la cuenta, siguiendo el estándar definido por BACEN
          content:
            application/jwt:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /opus-open-finance/automatic-payments/v1/recurring-consents/{recurringConsentId}/authorisation-retry:
    post:
      tags:
        - Opus Open Finance
      operationId: oofcAutomaticPaymentsPostRecurringConsentsConsentIdAuthorisationRetry
      description: Método para generar una nueva URL de autorización para el consentimiento identificado por consentId
      summary: Generar nueva URL de autorización para el consentimiento identificado por consentId.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RetryPaymentConsentRequest"
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/recurringConsentId"
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RetryPaymentConsentResponse"
  /opus-open-finance/automatic-payments/v1/recurring-consents/{recurringConsentId}:
    get:
      operationId: oofcAutomaticPaymentsGetRecurringConsentsConsentId
      description: Método para buscar información sobre un consentimiento de larga duración.
      tags:
        - Opus Open Finance
      summary: Buscar información de un consentimiento.
      externalDocs:
        description: Open Finance - API Payment Initiation
        url: https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/recurringConsentId"
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetAutomaticPaymentRecurringConsentResponse"
        "400":
          description: Error enviado por la institución detentora, siguiendo el estándar definido por BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Error enviado por la institución detentora, siguiendo el estándar definido por BACEN
          content:
            application/jwt:
              schema:
                $ref: "#/components/schemas/ResponseError"
    patch:
      operationId: oofcAutomaticPaymentsPatchRecurringConsentsConsentId
      description: |
        Método para rechazar, revocar o editar un consentimiento de larga duración:  
        1 - Información sobre la revocación:
        - En caso de éxito, el consentimiento pasa al estado “REVOKED”;
        - Solo consentimientos con estado “AUTHORISED” pueden ser revocados;
        - Pagos automáticos asociados al consentimiento y que estén programados para ocurrir hasta las 23:59h del día siguiente (a partir del día de la solicitud de revocación) deben mantenerse. Pagos programados para después de ese período deben ser cancelados.
        - Más orientaciones sobre la revocación pueden encontrarse en el encabezado de la API, en el tema “Validaciones”, ítem 3.

        2 - Información sobre la edición:
        - Los campos editables y sus reglas pueden encontrarse en el siguiente enlace: https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410772
        - La edición solo es posible para consentimientos de Pix Automático (“automatic” elegido en el oneOf del objeto “recurringConfiguration”);
        - El envío de "/data/creditors/name" actualizará el nombre del receptor en todos los elementos del arreglo.

        3 - Información sobre el rechazo:
        - Si es necesario cancelar un consentimiento aún no autorizado, el iniciador podrá llamar este endpoint para mover el consentimiento a REJECTED.
      tags:
        - Opus Open Finance
      summary: Rechaza, revoca o edita un consentimiento.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatchRecurringConsentRequest"
      externalDocs:
        description: Open Finance - API Payment Initiation
        url: https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/recurringConsentId"
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatchAutomaticPaymentRecurringConsentResponse"
        "400":
          description: Error enviado por la institución detentora, siguiendo el estándar BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Error enviado por la institución detentora, siguiendo el estándar BACEN
          content:
            application/jwt:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /opus-open-finance/participants:
    get:
      operationId: oofcGetParticipants
      description: Método para obtener los participantes registrados en el directorio
      tags:
        - Opus Open Finance
      summary: Detalle de los participantes registrados en el directorio, identificando sus APIs
      externalDocs:
        description: Open Finance - Funciones regulatorias para mapeos OpenID y OAuth 2.0
        url: https://openbanking-brasil.github.io/specs-seguranca/open-banking-brasil-dynamic-client-registration-1_ID2-ptbr.html#section-7.2
      parameters:
        - in: query
          name: role
          schema:
            type: string
          description: Filtra OrgDomainRoleClaims que contengan el role informado. Los tipos de role están sujetos a cambios; verificar en externalDocs.
        - in: query
          name: familyType
          schema:
            type: string
          description: Filtra ApiResources que contengan el familyType informado
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ParticipantsResponse"
        "502":
          description: Error en Opus Open Client al comunicarse con la API de participantes del BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la API de participantes del BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /proxy/open-banking/automatic-payments/v1/pix/recurring-payments:
    post:
      tags:
        - Pagamento Automático
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerRecurringConsentId"
      description: "Método para crear una transacción de pago. Devuelve un recurringPaymentId."
      requestBody:
        content:
          application/json:
            schema:
              description: "Sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/345178397/Informa+es+T+cnicas+-+SV+Pagamentos+Autom+ticos+-+v1.0.0))."
              example: {}
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por BACEN
    get:
      tags:
        - Pagamento Automático
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerRecurringConsentId"
      description: |
        Método para buscar información sobre un conjunto de pagos asociados al mismo recurringConsentId.
        También es posible enviar una fecha de inicio (startDate) y una fecha de fin (endDate) en caso de búsqueda por una ventana específica de tiempo.
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por BACEN
  /proxy/open-banking/automatic-payments/v1/pix/recurring-payments/{recurringPaymentId}:
    get:
      tags:
        - Pagamento Automático
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerRecurringConsentId"
        - name: recurringPaymentId
          in: path
          description: Identificador de la operación de pago
          schema:
            type: string
          required: true
          example: D730A10D6784379085391417F3EF657C1247B2B3645210DD97F739B33B349376
      description: Método proxy para consultar una iniciación de pago.
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por BACEN
    patch:
      tags:
        - Pagamento Automático
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerRecurringConsentId"
        - name: recurringPaymentId
          in: path
          description: Identificador de la operación de pago
          schema:
            type: string
          required: true
          example: D730A10D6784379085391417F3EF657C1247B2B3645210DD97F739B33B349376
      description: Método proxy para revocar una iniciación de pago.
      requestBody:
        content:
          application/json:
            schema:
              description: "Sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/347079010/Informa+es+T+cnicas+-+SV+Pagamentos+-+v4.0.0))."
              example: {}
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por BACEN
  /opus-open-finance/dcm:
    get:
      operationId: oofcGetDcm
      description: Método para obtener los datos de DCM de todos los brand clients de la aplicación.
      tags:
        - Opus Open Finance
      summary: Detalle de la situación de DCM de los brand clients.
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DcmData"
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la API de participantes del BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
    put:
      operationId: oofcPutDcm
      description: Método para actualizar los datos de DCM de todos los brand clients de la aplicación.
      tags:
        - Opus Open Finance
      summary: Actualización de los datos de DCM de los brand clients.
      parameters:
        - $ref: "#/components/parameters/applicationId"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PutDcmRequest"
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DcmData"
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de la cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Tiempo límite de conexión excedido al comunicarse con la API de participantes del BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /opus-open-finance/authorization-result:
    post:
      tags:
        - Opus Open Finance
      operationId: oofcAppToAppAuthorizationResult
      description: Método utilizado en el flujo App-To-App para intercambiar el authorization code retornado por los tokens o para manejar eventuales errores de autorización.
      summary: Enviar retorno del flujo OIDC al Opus TPP.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AppToAppAuthorizationResultRequest"
      responses:
        "204":
          description: Proceso de autorización exitoso
        "422":
          description: Error en el proceso de autorización
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppToAppAuthorizationErrorResponse"
components:
  schemas:
    PutDcmRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - version
          properties:
            version:
              type: string
              description: Cadena de versión
              example: "1"
    RetryPaymentConsentRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - callbackApplicationUri
          properties:
            callbackApplicationUri:
              type: string
              format: uri
              maxLength: 2000
              description: URI de callback de la aplicación después del proceso de autenticación
              example: "https://aplicativo.instituicao.com.br"
              pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
    RetryPaymentConsentResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - redirectUrl
            - recurringConsentId
            - consent
          properties:
            redirectUrl:
              type: string
              format: uri
              maxLength: 2000
              description: URI de redirección hacia el Authorisation Server de la institución detentora para solicitar aprobación del consentimiento
              example: "https://authorisation-server.detentora.com.br"
              pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
            recurringConsentId:
              description: |
                El recurringConsentId es el identificador único del consentimiento y debe ser un URN (Uniform Resource Name).
                Un URN, según lo definido en la RFC8141, es un URI asignado bajo el esquema "urn" con un namespace URN específico,
                destinado a ser persistente e independiente de la localización.
                Ejemplo: urn:bancoex:C1DD33123
                - namespace (urn)
                - identificador asociado al namespace de la institución emisora (bancoex)
                - identificador específico dentro del namespace (C1DD33123)
              type: string
              pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
              maxLength: 256
              example: "urn:bancoex:C1DD33123"
            consent:
              type: string
              description: Objeto de consentimiento de pago retornado por la detentora según el estándar BACEN – https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos
    ParticipantsResponse:
      type: array
      items:
        $ref: "#/components/schemas/Participants"
    Participants:
      type: object
      required:
        - OpenIDDiscoveryDocument
        - CustomerFriendlyName
        - CustomerFriendlyLogoUri
        - Organisations
        - AuthorisationServerIds
        - ApiResources
      properties:
        OpenIDDiscoveryDocument:
          type: string
          format: uri
          maxLength: 2000
          description: URI de discovery del Authorisation Server de la institución detentora
          example: "https://open-finance.detentora.com.br/.well-known/openid-configuration"
          pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
        CustomerFriendlyName:
          type: string
          maxLength: 255
          example: "Institución Detentora de Cuenta Open Finance"
        CustomerFriendlyLogoUri:
          type: string
          format: uri
          maxLength: 2000
          example: "https://cdn.raidiam.io/directory-ui/brand/obbrazil/0.2.0.112/favicon.svg"
          pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
        CustomerFriendlyDescription:
          type: string
          maxLength: 255
          example: "Descripción de la Institución Detentora de Cuenta Open Finance"
        Organisations:
          type: array
          minLength: 1
          items:
            required:
              - OrganisationId
              - RegistrationNumber
            properties:
              OrganisationId:
                type: string
                description: Identificador único de la organización
                minLength: 1
                maxLength: 40
                example: "ce31b1e1-71c5-4918-ba5b-3e8f6401c71f"
              RegisteredName:
                type: string
                maxLength: 256
                example: "Detentora de Cuenta S.A."
              RegistrationNumber:
                type: string
                maxLength: 256
                example: "60663556000104"
              ParentOrganisationReference:
                type: string
                maxLength: 65535
                example: "60701190000104"
        OrgDomainRoleClaims:
          type: array
          minLength: 1
          items:
            required:
              - Status
              - role
            properties:
              Status:
                type: string
                example: Active
              role:
                $ref: "#/components/schemas/EnumRole"
        AuthorisationServerIds:
          type: array
          items:
            type: string
            maxLength: 40
            example: a9e62501-0b91-4af9-837d-c2d210736f28
        ApiResources:
          type: array
          items:
            properties:
              ApiFamilyType:
                type: string
                minLength: 1
                maxLength: 40
                example: payments-consents
              ApiVersion:
                type: number
                example: 1
    AssetLinks:
      type: array
      items:
        type: object
        properties:
          relation:
            type: array
            items:
              type: string
              example: "delegate_permission/common.handle_all_urls"
          target:
            type: object
            properties:
              namespace:
                type: string
                example: "android_app"
              package_name:
                type: string
                example: "example.com"
              sha256_cert_fingerprints:
                type: array
                items:
                  type: string
                  example: "A1:22:30:35:08:85:CC:4D:B6:A6:6C:02:4C:9F:3C:FE:07:CA:39:4C:66:30:C0:1F:00:FA:43:BE:3E:8E:94:3D"
    AppleAppSiteAssociation:
      type: object
      properties:
        applinks:
          type: object
          properties:
            apps:
              type: array
              items:
                type: object
            details:
              type: array
              items:
                type: object
                properties:
                  appID:
                    type: string
                    example: "app.native.example"
                  paths:
                    type: array
                    items:
                      type: string
                      example: "/auth/handoff/*"
                  appIDs:
                    type: array
                    items:
                      type: string
                      example: "app.native.example"
                  components:
                    type: array
                    items:
                      type: object
                      properties:
                        /:
                          type: string
                          example: "/auth/auth"
    AppToAppAuthorizationResultRequest:
      type: object
      properties:
        data:
          type: string
          example: "code=LxSevzQNevQJM0yx4dhPo4oJHdYhAHG808ssYF2OlzC&id_token=eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IkVKU01fbW1UMV9qTTVieTM5aEttR01BSWNTM2lzQ3BPSlB5NVdnUmY3RUUifQ.eyJzdWIiOiJPRkMtNDkzOGI1ODIzZWQzNjMxNmQyZTVjYzY5M2YxNzljMTJjNTE0MjNlYTQ0NzJiYjgyZWI5YWYzNTE0NjEyYmI2MSIsImF1dGhfdGltZSI6MTY5NTY3NjE2MCwiYWNyIjoidXJuOmJyYXNpbDpvcGVuYmFua2luZzpsb2EyIiwibm9uY2UiOiIzNjE2YzM3NWFjMDZlODBjMTk3MjljMTkwOGEzYjkxMGQ3ODVlYzViZTkxOTZhN2YyZjllZjhmNDI1YmVlNWMxIiwiY19oYXNoIjoiRUVMd2FoU1FQUGt2WEZWZzJOZnRHUSIsInNfaGFzaCI6IndPN1hZbFB1c1FZMGtwOG1Ucmw3WVEiLCJhdWQiOiI1aUtkV3JCdlhFRjJHNWgwZ1RaMkMiLCJleHAiOjE2OTU2NzcwNjAsImlhdCI6MTY5NTY3NjE2MCwiaXNzIjoiaHR0cHM6Ly9vYmIucWEub29iLm9wdXMtc29mdHdhcmUuY29tLmJyLyJ9.SNBN_Buh_Y0iLuJGP4bgSHYnSKC_g76R0CpWEVRJua788RNoJpAzhAm6Ah6vOb2nD-H4Yq2MAjRy_Fkh7ruziBaJ4ebDexxQ2GAocBgrmQ2JwI-Q-1D4Xm1WuSS6OSm04Kk0CiV8MylidwxF_4XS40uWqxTJQcgG8dP4NC9-ty8S6a-6oGs0MekjOqm9mU0aFDwS8fRGZ8TU-8AT15hiMQ9sXsgNlfrci0MQi9Jb6t9o4c93mKCLhGypYswjs1MjVoXD3K6btZ2NSZYBQROtTK_tl9HkvW1uRVhNVZjzwDs1DJrvZpLP48es8YPxFtYAAKsuwiB8bza58MYKvvW81A&state=dXJuOmFtYXppbmdiYW5rOjdlOWYxMDhmLWE3MDktNDBlNi1iMzQ2LTNjNGZiMzBjNjcyNnwx"
    AppToAppAuthorizationErrorResponse:
      type: object
      properties:
        error:
          type: string
          example: "access_denied"
        error_description:
          type: string
          example: "Error en la autenticación del usuario"
    DcmData:
      type: object
      required:
        - data
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/DcmStatus"
    DcmStatus:
      type: object
      required:
        - brandId
        - dcmVersion
        - dcmDate
      properties:
        brandId:
          type: string
          maxLength: 40
          example: a9e62501-0b91-4af9-837d-c2d210736f28
        dcmVersion:
          type: string
          maxLength: 20
          example: "2.0"
        dcmDate:
          description: "Fecha y hora de la realización del DCM de la versión indicada, según especificación RFC-3339, en formato UTC."
          type: string
          maxLength: 20
          format: date-time
          example: "2023-07-07T09:30:00Z"
        status:
          type: string
          maxLength: 20
          example: "success"
    GetAutomaticPaymentRecurringConsentResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - recurringConsentId
            - consent
          properties:
            recurringConsentId:
              description: |
                Identificador único del consentimiento de larga duración creado para la iniciación de pago solicitada.
                Debe ser un URN (Uniform Resource Name). Un URN, según la RFC8141, es un URI bajo el esquema "urn"
                y un namespace específico, diseñado para ser persistente e independiente de la localización.

                Ejemplo: **urn:bancoex:C1DD33123**
                - namespace (urn)
                - identificador del namespace de la institución emisora (bancoex)
                - identificador específico dentro del namespace (C1DD33123)

                Para información adicional sobre namespaces, consulte la RFC8141.
              type: string
              pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
              maxLength: 256
              example: "urn:bancoex:C1DD33123"
            consent:
              type: string
              description: Objeto de consentimiento de pago retornado por la detentora, según estándar BACEN — https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos
    PatchAutomaticPaymentRecurringConsentResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - recurringConsentId
            - consent
          properties:
            recurringConsentId:
              description: |
                Identificador único del consentimiento de larga duración creado para la iniciación de pago solicitada.
                Debe ser un URN — Uniform Resource Name, en conformidad con la RFC8141.

                Ejemplo: **urn:bancoex:C1DD33123**
                - namespace (urn)
                - identificador del namespace de la institución emisora (bancoex)
                - identificador específico dentro del namespace (C1DD33123)
              type: string
              pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
              maxLength: 256
              example: "urn:bancoex:C1DD33123"
            consent:
              type: string
              description: Objeto de revocación del consentimiento de pago retornado por la detentora, conforme al estándar BACEN — https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos
    CreateRecurringConsentResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - redirectUrl
            - recurringConsentId
            - consent
          properties:
            redirectUrl:
              type: string
              format: uri
              maxLength: 2000
              description: URI de redirección hacia el Authorisation Server de la institución detentora para solicitar aprobación del consentimiento
              example: "https://authorisation-server.detentora.com.br"
              pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
            recurringConsentId:
              description: |
                El consentId es el identificador único del consentimiento y debe ser un URN.
                Según la RFC8141, un URN es un identificador persistente e independiente de localización.

                Ejemplo: **urn:bancoex:C1DD33123**
                - namespace (urn)
                - identificador del namespace (bancoex)
                - identificador específico (C1DD33123)
              type: string
              pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
              maxLength: 256
              example: "urn:bancoex:C1DD33123"
            consent:
              type: string
              description: Objeto de consentimiento retornado por la institución detentora según el estándar BACEN — https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos
    Meta:
      type: object
      description: Metainformaciones referentes a la API solicitada.
      required:
        - totalRecords
        - totalPages
        - requestDateTime
      properties:
        totalRecords:
          type: integer
          format: int32
          description: Número total de registros en el resultado
          example: 1
        totalPages:
          type: integer
          format: int32
          description: Número total de páginas en el resultado
          example: 1
        requestDateTime:
          description: "Fecha y hora de la consulta, conforme especificación RFC-3339, formato UTC."
          type: string
          maxLength: 20
          format: date-time
          example: "2021-05-21T08:30:00Z"
      additionalProperties: false
    CreateRecurringConsentRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          description: Objeto que contiene la información del consentimiento para la iniciación de pago. Para los demás campos, sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos)).
          required:
            - callbackApplicationUri
          properties:
            callbackApplicationUri:
              type: string
              format: uri
              maxLength: 2000
              description: URI de callback de la aplicación después del proceso de autenticación
              example: "https://aplicativo.instituicao.com.br"
              pattern: '^(https?:\\/\\/)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&\\/\\/=]*)$'
    PatchRecurringConsentRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          description: Objeto que contiene la información del consentimiento para la iniciación de pago. Para los campos sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/198410569/SV+API+-+Pagamentos+Autom+ticos)).
    EnumRole:
      type: string
      maxLength: 5
      enum:
        - DADOS
        - PAGTO
        - CONTA
        - CCORR
      example: CONTA
      description: |
        Rol regulatorio de la institución. Los tipos de roles están sujetos a cambios.
    UUID:
      format: uuid
      pattern: "[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}"
      type: string
      example: "556392bd-b4c2-4cc0-9abe-f2c77a5c5d8f"
    ResponseError:
      type: object
      required:
        - errors
      properties:
        errors:
          type: array
          minItems: 1
          maxItems: 13
          items:
            type: object
            required:
              - code
              - title
              - detail
            properties:
              code:
                description: Código de error específico del endpoint
                type: string
                pattern: '[\\w\\W\\s]*'
                example: "4XX"
                maxLength: 255
              title:
                description: Título legible por humanos para este error específico
                type: string
                example: "Título legible por humanos de este error específico"
                pattern: '[\\w\\W\\s]*'
                maxLength: 255
              detail:
                description: Descripción legible por humanos de este error específico
                type: string
                example: "Descripción legible por humanos de este error específico"
                pattern: '[\\w\\W\\s]*'
                maxLength: 2048
            additionalProperties: false
        meta:
          $ref: "#/components/schemas/Meta"
      additionalProperties: false
  parameters:
    applicationId:
      name: x-application-id
      in: header
      required: true
      description: Identificador de la aplicación que realiza la solicitud
      schema:
        $ref: "#/components/schemas/UUID"
    authorisationServerId:
      name: x-authorisation-server-id
      required: true
      description: Identificador del Authorisation Server de la transmisora del consentimiento, obtenido mediante la consulta de la lista de participantes
      in: header
      schema:
        $ref: "#/components/schemas/UUID"
    headerRecurringConsentId:
      name: x-recurring-consent-id
      required: true
      in: header
      description: Identificador del consentimiento que se utilizará en esta operación, obtenido en la respuesta de creación del mismo
      schema:
        type: string
        pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\\-.:=@;$_!*''%\\/\\?#]+$'
        maxLength: 256
      example: "urn:bancox:f865cd66-392a-420b-9ff0-1b6d7cc60ee0"
    recurringConsentId:
      name: recurringConsentId
      required: true
      in: path
      description: |
        El recurringConsentId es el identificador único del consentimiento de larga duración.
        Debe ser un URN (Uniform Resource Name), según la RFC8141.

        Ejemplo: **urn:bancoex:C1DD33123**
        - namespace (urn)
        - identificador asociado al namespace de la institución detentora (bancoex)
        - identificador específico dentro del namespace (C1DD33123)

        Para más detalles sobre la construcción de namespaces, consulte la RFC8141.
      schema:
        type: string
        pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\\-.:=@;$_!*''%\\/\\?#]+$'
        maxLength: 256
      example: "urn:bancox:f865cd66-392a-420b-9ff0-1b6d7cc60ee0"
