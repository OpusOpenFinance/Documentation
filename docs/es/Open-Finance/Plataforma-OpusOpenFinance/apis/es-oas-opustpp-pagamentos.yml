openapi: 3.0.0
info:
  title: oofc-core
  description: |-
    Opus Open Client - Núcleo de gestión de consentimientos

    # Iniciación de Transacción de Pagos

    Para más información sobre el flujo de creación de consentimiento, consulte la documentación de la Plataforma Opus Open Finance.
  version: 1.0.0
tags:
  - name: Opus Open Finance
    description: |-
      Endpoints de gestión de consentimientos
  - name: Pagamento
    description: |-
      Endpoints de iniciación de pagos relacionados al consentimiento.  
      Los modelos de datos esperados y devueltos son los mismos definidos por la documentación oficial  
      ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/17375943/API+-+Pagamentos)).
  - name: Deeplinks
    description: |-
      Endpoints para obtener las configuraciones de iOS Universal Links y Android App Links 
      para que la aplicación de la Institución receptora pueda interceptar URLs.
servers:
  - url: https://open-finance-core.instituicao.com.br
paths:
  /.well-known/assetlinks.json:
    get:
      tags:
        - Deeplinks
      operationId: oofcDeeplinksGetAssetLinks
      description: Método para obtener el contenido del archivo assetlinks.json
      summary: Obtener archivo de configuración de Android App Links
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AssetLinks"
  /.well-known/apple-app-site-association:
    get:
      tags:
        - Deeplinks
      operationId: oofcDeeplinksGetAppleAppSiteAssociation
      description: Método para obtener el contenido del archivo apple-app-site-association
      summary: Obtener archivo de configuración Apple App Site Association
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppleAppSiteAssociation"
  /opus-open-finance/payments/v1/consents:
    post:
      tags:
        - Opus Open Finance
      operationId: oofcPaymentsPostConsents
      description: Método para crear una nueva solicitud de consentimiento de pago
      summary: Crear nueva solicitud de consentimiento de pago
      externalDocs:
        description: Open Finance - API Payment Initiation
        url: https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/17375943/API+-+Pagamentos
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePaymentConsentRequest"
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "201":
          description: Consentimiento de pago creado con éxito.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreatePaymentConsentResponse"
        "400":
          description: Error enviado por la institución detentora, siguiendo el estándar definido por BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Error enviado por la institución detentora, siguiendo el estándar definido por BACEN
          content:
            application/jwt:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /opus-open-finance/payments/v1/consents/{consentId}/authorisation-retry:
    post:
      tags:
        - Opus Open Finance
      operationId: oofcPaymentsPostConsentsConsentIdAuthorisationRetry
      description: Método para generar una nueva URL de autorización para el consentimiento identificado por consentId
      summary: Generar nueva URL de autorización para el consentimiento identificado por consentId.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RetryPaymentConsentRequest"
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/consentId"
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RetryPaymentConsentResponse"
  /opus-open-finance/payments/v1/consents/{consentId}:
    get:
      operationId: oofcPaymentsGetConsentsConsentId
      description: Método para obtener el detalle del consentimiento de pago identificado por consentId
      tags:
        - Opus Open Finance
      summary: Obtener detalles del consentimiento identificado por consentId.
      externalDocs:
        description: Open Finance - API Payment Initiation
        url: https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/17375943/API+-+Pagamentos
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/consentId"
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetPaymentConsentResponse"
        "400":
          description: Error enviado por la institución detentora, siguiendo el estándar definido por BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Error enviado por la institución detentora, siguiendo el estándar definido por BACEN
          content:
            application/jwt:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /opus-open-finance/participants:
    get:
      operationId: oofcGetParticipants
      description: Método para obtener los participantes registrados en el directorio
      tags:
        - Opus Open Finance
      summary: Detalle de los participantes registrados en el directorio, identificando sus APIs
      externalDocs:
        description: Open Finance - Funciones regulatorias para mapeos OpenID y OAuth 2.0
        url: https://openbanking-brasil.github.io/specs-seguranca/open-banking-brasil-dynamic-client-registration-1_ID2-ptbr.html#section-7.2
      parameters:
        - in: query
          name: role
          schema:
            type: string
          description:
            Filtra OrgDomainRoleClaims que contengan el role informado.
            Los tipos de roles están sujetos a cambios; verificar en el documento de referencia.
        - in: query
          name: familyType
          schema:
            type: string
          description: Filtra ApiResources que contengan el familyType informado
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ParticipantsResponse"
        "502":
          description: Error en Opus Open Client al comunicarse con la API de participantes del BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la API de participantes del BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /proxy/open-banking/payments/v3/pix/payments:
    post:
      tags:
        - Pagamento
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerConsentId"
      description: "Método proxy para crear una iniciación de pago."
      requestBody:
        content:
          application/json:
            schema:
              description: "Sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/142671873/v3.0.0-beta.2+-+Pagamentos))."
              example: {}
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por el BACEN
  /proxy/open-banking/payments/v4/pix/payments:
    post:
      tags:
        - Pagamento
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerConsentId"
      description: "Método proxy para crear una iniciación de pago."
      requestBody:
        content:
          application/json:
            schema:
              description: "Sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/347079010/Informa+es+T+cnicas+-+SV+Pagamentos+-+v4.0.0))."
              example: {}
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por el BACEN
  /proxy/open-banking/payments/v3/pix/payments/{paymentId}:
    get:
      tags:
        - Pagamento
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerConsentId"
        - name: paymentId
          in: path
          description: Identificador de la operación de pago
          schema:
            type: string
          required: true
          example: D730A10D6784379085391417F3EF657C1247B2B3645210DD97F739B33B349376
      description: Método proxy para consultar una iniciación de pago.
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por el BACEN
    patch:
      tags:
        - Pagamento
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerConsentId"
        - name: paymentId
          in: path
          description: Identificador de la operación de pago
          schema:
            type: string
          required: true
          example: D730A10D6784379085391417F3EF657C1247B2B3645210DD97F739B33B349376
      description: Método proxy para revocar una iniciación de pago.
      requestBody:
        content:
          application/json:
            schema:
              description: "Sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/142671873/v3.0.0-beta.2+-+Pagamentos))."
              example: {}
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por el BACEN
  /proxy/open-banking/payments/v4/pix/payments/{paymentId}:
    get:
      tags:
        - Pagamento
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerConsentId"
        - name: paymentId
          in: path
          description: Identificador de la operación de pago
          schema:
            type: string
          required: true
          example: D730A10D6784379085391417F3EF657C1247B2B3645210DD97F739B33B349376
      description: Método proxy para consultar una iniciación de pago.
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por el BACEN
    patch:
      tags:
        - Pagamento
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerConsentId"
        - name: paymentId
          in: path
          description: Identificador de la operación de pago
          schema:
            type: string
          required: true
          example: D730A10D6784379085391417F3EF657C1247B2B3645210DD97F739B33B349376
      description: Método proxy para revocar una iniciación de pago.
      requestBody:
        content:
          application/json:
            schema:
              description: "Sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/347079010/Informa+es+T+cnicas+-+SV+Pagamentos+-+v4.0.0))."
              example: {}
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por el BACEN
  /proxy/open-banking/payments/v4/pix/payments/consents/{consentId}:
    patch:
      tags:
        - Pagamento
      parameters:
        - $ref: "#/components/parameters/applicationId"
        - $ref: "#/components/parameters/authorisationServerId"
        - $ref: "#/components/parameters/headerConsentId"
        - name: consentId
          in: path
          description: Identificador del consentimiento
          schema:
            type: string
          required: true
          example: urn:amazingbank:5e456567-e53c-41c4-80f6-b16bcd63d243
      description: Método proxy para revocar todos los pagos relacionados con el mismo consentimiento.
      requestBody:
        content:
          application/json:
            schema:
              description: "Sigue el estándar de solicitud definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/347079010/Informa+es+T+cnicas+-+SV+Pagamentos+-+v4.0.0))."
              example: {}
      responses:
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        default:
          description: Sigue el estándar de respuesta definido por el BACEN
  /opus-open-finance/dcm:
    get:
      operationId: oofcGetDcm
      description: Método para obtener los datos de DCM de todos los brand clients de la aplicación.
      tags:
        - Opus Open Finance
      summary: Detalle del estado de DCM de los brand clients.
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DcmData"
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la API de participantes del BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
    put:
      operationId: oofcPutDcm
      description: Método para actualizar los datos de DCM de todos los brand clients de la aplicación.
      tags:
        - Opus Open Finance
      summary: Actualización de los datos de DCM de los brand clients.
      parameters:
        - $ref: "#/components/parameters/applicationId"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PutDcmRequest"
      responses:
        "200":
          description: Respuesta exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DcmData"
        "502":
          description: Error en Opus Open Client al comunicarse con la institución detentora de cuenta
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
        "504":
          description: Límite de tiempo excedido al comunicarse con la API de participantes del BACEN
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseError"
  /opus-open-finance/authorization-result:
    post:
      tags:
        - Opus Open Finance
      operationId: oofcAppToAppAuthorizationResult
      description: Método utilizado en el flujo App-To-App para intercambiar el authorization code recibido por los tokens o para manejar posibles errores de autorización.
      summary: Enviar el retorno del flujo OIDC al Opus TPP.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AppToAppAuthorizationResultRequest"
      responses:
        "204":
          description: Éxito en el proceso de autorización
        "422":
          description: Error en el proceso de autorización
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AppToAppAuthorizationErrorResponse"
components:
  schemas:
    PutDcmRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - version
          properties:
            version:
              type: string
              description: Cadena de la versión
              example: "1"
    RetryPaymentConsentRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - callbackApplicationUri
          properties:
            callbackApplicationUri:
              type: string
              format: uri
              maxLength: 2000
              description: URI de callback de la aplicación después del proceso de autenticación
              example: "https://aplicativo.instituicao.com.br"
              pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
    RetryPaymentConsentResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - redirectUrl
            - consentId
            - consent
          properties:
            redirectUrl:
              type: string
              format: uri
              maxLength: 2000
              description: URI de redireccionamiento hacia el Authorisation Server de la institución detentora para solicitar aprobación del consentimiento
              example: "https://authorisation-server.detentora.com.br"
              pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
            consentId:
              description: |
                El consentId es el identificador único del consentimiento y debe ser un URN - Uniform Resource Name.

                Un URN, conforme definido en la [RFC8141](https://tools.ietf.org/html/rfc8141), es un Uniform Resource Identifier (URI)
                asignado bajo el esquema "urn" y un namespace URN específico, con la intención de ser un identificador persistente
                e independiente de la localización.

                Considerando la cadena urn:bancoex:C1DD33123 como ejemplo de consentId, tenemos:
                - el namespace (urn)
                - el identificador asociado al namespace de la institución transmisora (bancoex)
                - el identificador específico dentro del namespace (C1DD33123)

                Para informaciones más detalladas sobre la construcción de namespaces, consultar la RFC8141.
              type: string
              pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
              maxLength: 256
              example: "urn:bancoex:C1DD33123"
            consent:
              type: string
              description: Objeto de consentimiento de pago retornado por la institución detentora según el estándar del BACEN - https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/17375943/API+-+Pagamentos
    ParticipantsResponse:
      type: array
      items:
        $ref: "#/components/schemas/Participants"
    Participants:
      type: object
      required:
        - OpenIDDiscoveryDocument
        - CustomerFriendlyName
        - CustomerFriendlyLogoUri
        - Organisations
        - AuthorisationServerIds
        - ApiResources
      properties:
        OpenIDDiscoveryDocument:
          type: string
          format: uri
          maxLength: 2000
          description: URI de discovery del Authorisation Server de la institución detentora
          example: "https://open-finance.detentora.com.br/.well-known/openid-configuration"
          pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
        CustomerFriendlyName:
          type: string
          maxLength: 255
          example: "Institución Detentora de Cuenta Open Finance"
        CustomerFriendlyLogoUri:
          type: string
          format: uri
          maxLength: 2000
          example: "https://cdn.raidiam.io/directory-ui/brand/obbrazil/0.2.0.112/favicon.svg"
          pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
        CustomerFriendlyDescription:
          type: string
          maxLength: 255
          example: "Descripción de la Institución Detentora de Cuenta Open Finance"
        Organisations:
          type: array
          minLength: 1
          items:
            required:
              - OrganisationId
              - RegistrationNumber
            properties:
              OrganisationId:
                type: string
                description: Identificador único de la organización
                minLength: 1
                maxLength: 40
                example: "ce31b1e1-71c5-4918-ba5b-3e8f6401c71f"
              RegisteredName:
                type: string
                maxLength: 256
                example: "Detentora de Conta S.A."
              RegistrationNumber:
                type: string
                maxLength: 256
                example: "60663556000104"
              ParentOrganisationReference:
                type: string
                maxLength: 65535
                example: "60701190000104"
        OrgDomainRoleClaims:
          type: array
          minLength: 1
          items:
            required:
              - Status
              - role
            properties:
              Status:
                type: string
                example: Active
              role:
                $ref: "#/components/schemas/EnumRole"
        AuthorisationServerIds:
          type: array
          items:
            type: string
            maxLength: 40
            example: a9e62501-0b91-4af9-837d-c2d210736f28
        ApiResources:
          type: array
          items:
            properties:
              ApiFamilyType:
                type: string
                minLength: 1
                maxLength: 40
                example: payments-consents
              ApiVersion:
                type: number
                example: 1
    AssetLinks:
      type: array
      items:
        type: object
        properties:
          relation:
            type: array
            items:
              type: string
              example: "delegate_permission/common.handle_all_urls"
          target:
            type: object
            properties:
              namespace:
                type: string
                example: "android_app"
              package_name:
                type: string
                example: "example.com"
              sha256_cert_fingerprints:
                type: array
                items:
                  type: string
                  example: "A1:22:30:35:08:85:CC:4D:B6:A6:6C:02:4C:9F:3C:FE:07:CA:39:4C:66:30:C0:1F:00:FA:43:BE:3E:8E:94:3D"
    AppleAppSiteAssociation:
      type: object
      properties:
        applinks:
          type: object
          properties:
            apps:
              type: array
              items:
                type: object
            details:
              type: array
              items:
                type: object
                properties:
                  appID:
                    type: string
                    example: "app.native.example"
                  paths:
                    type: array
                    items:
                      type: string
                      example: "/auth/handoff/*"
                  appIDs:
                    type: array
                    items:
                      type: string
                      example: "app.native.example"
                  components:
                    type: array
                    items:
                      type: object
                      properties:
                        /:
                          type: string
                          example: "/auth/auth"
    AppToAppAuthorizationResultRequest:
      type: object
      properties:
        data:
          type: string
          example: "code=LxSevzQNevQJM0yx4dhPo4oJHdYhAHG808ssYF2OlzC&id_token=eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IkVKU01fbW1UMV9qTTVieTM5aEttR01BSWNTM2lzQ3BPSlB5NVdnUmY3RUUifQ.eyJzdWIiOiJPRkMtNDkzOGI1ODIzZWQzNjMxNmQyZTVjYzY5M2YxNzljMTJjNTE0MjNlYTQ0NzJiYjgyZWI5YWYzNTE0NjEyYmI2MSIsImF1dGhfdGltZSI6MTY5NTY3NjE2MCwiYWNyIjoidXJuOmJyYXNpbDpvcGVuYmFua2luZzpsb2EyIiwibm9uY2UiOiIzNjE2YzM3NWFjMDZlODBjMTk3MjljMTkwOGEzYjkxMGQ3ODVlYzViZTkxOTZhN2YyZjllZjhmNDI1YmVlNWMxIiwiY19oYXNoIjoiRUVMd2FoU1FQUGt2WEZWZzJOZnRHUSIsInNfaGFzaCI6IndPN1hZbFB1c1FZMGtwOG1Ucmw3WVEiLCJhdWQiOiI1aUtkV3JCdlhFRjJHNWgwZ1RaMkMiLCJleHAiOjE2OTU2NzcwNjAsImlhdCI6MTY5NTY3NjE2MCwiaXNzIjoiaHR0cHM6Ly9vYmIucWEub29iLm9wdXMtc29mdHdhcmUuY29tLmJyLyJ9.SNBN_Buh_Y0iLuJGP4bgSHYnSKC_g76R0CpWEVRJua788RNoJpAzhAm6Ah6vOb2nD-H4Yq2MAjRy_Fkh7ruziBaJ4ebDexxQ2GAocBgrmQ2JwI-Q-1D4Xm1WuSS6OSm04Kk0CiV8MylidwxF_4XS40uWqxTJQcgG8dP4NC9-ty8S6a-6oGs0MekjOqm9mU0aFDwS8fRGZ8TU-8AT15hiMQ9sXsgNlfrci0MQi9Jb6t9o4c93mKCLhGypYswjs1MjVoXD3K6btZ2NSZYBQROtTK_tl9HkvW1uRVhNVZjzwDs1DJrvZpLP48es8YPxFtYAAKsuwiB8bza58MYKvvW81A&state=dXJuOmFtYXppbmdiYW5rOjdlOWYxMDhmLWE3MDktNDBlNi1iMzQ2LTNjNGZiMzBjNjcyNnwx"
    AppToAppAuthorizationErrorResponse:
      type: object
      properties:
        error:
          type: string
          example: "access_denied"
        error_description:
          type: string
          example: "Error en la autenticación del usuario"
    DcmData:
      type: object
      required:
        - data
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/DcmStatus"
    DcmStatus:
      type: object
      required:
        - brandId
        - dcmVersion
        - dcmDate
      properties:
        brandId:
          type: string
          maxLength: 40
          example: a9e62501-0b91-4af9-837d-c2d210736f28
        dcmVersion:
          type: string
          maxLength: 20
          example: "2.0"
        dcmDate:
          description: "Fecha y hora de realización del DCM de la versión indicada, conforme a la especificación RFC-3339, formato UTC."
          type: string
          maxLength: 20
          format: date-time
          example: "2023-07-07T09:30:00Z"
        status:
          type: string
          maxLength: 20
          example: "success"
    GetPaymentConsentResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - consentId
            - consent
          properties:
            consentId:
              description: |
                El consentId es el identificador único del consentimiento y deberá ser un URN - Uniform Resource Name.

                Un URN, conforme definido en la [RFC8141](https://tools.ietf.org/html/rfc8141),
                es un Uniform Resource Identifier (URI) asignado bajo el esquema "urn"
                y un namespace URN específico, diseñado para ser un identificador persistente e independiente de localización.

                Ejemplo: urn:bancoex:C1DD33123
                - namespace: urn
                - identificador asociado al namespace de la institución transmisora (bancoex)
                - identificador específico dentro del namespace (C1DD33123)
              type: string
              pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
              maxLength: 256
              example: "urn:bancoex:C1DD33123"
            consent:
              type: string
              description: Objeto de consentimiento de pago retornado por la institución detentora según el estándar del BACEN - https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/17375943/API+-+Pagamentos
    CreatePaymentConsentResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - redirectUrl
            - consentId
            - consent
          properties:
            redirectUrl:
              type: string
              format: uri
              maxLength: 2000
              description: URI de redireccionamiento hacia el Authorisation Server de la institución detentora para solicitar la aprobación del consentimiento
              example: "https://authorisation-server.detentora.com.br"
              pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
            consentId:
              description: |
                El consentId es el identificador único del consentimiento y deberá ser un URN - Uniform Resource Name.

                Un URN, conforme definido en la [RFC8141](https://tools.ietf.org/html/rfc8141),
                es un Uniform Resource Identifier (URI) asignado bajo el esquema "urn"
                y un namespace URN específico, diseñado para ser persistente y
                independiente de localización.

                Ejemplo: urn:bancoex:C1DD33123
                - namespace: urn
                - identificador asociado al namespace de la institución transmisora (bancoex)
                - identificador específico dentro del namespace (C1DD33123)
              type: string
              pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
              maxLength: 256
              example: "urn:bancoex:C1DD33123"
            consent:
              type: string
              description: Objeto de consentimiento de pago retornado por la institución detentora de cuenta según el estándar BACEN - https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/17375943/API+-+Pagamentos
    Meta:
      type: object
      description: Información meta referente a la API solicitada.
      required:
        - totalRecords
        - totalPages
        - requestDateTime
      properties:
        totalRecords:
          type: integer
          format: int32
          description: Número total de registros en el resultado
          example: 1
        totalPages:
          type: integer
          format: int32
          description: Número total de páginas en el resultado
          example: 1
        requestDateTime:
          description: "Fecha y hora de la consulta, conforme especificación RFC-3339, formato UTC."
          type: string
          maxLength: 20
          format: date-time
          example: "2021-05-21T08:30:00Z"
      additionalProperties: false
    CreatePaymentConsentRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          description: Objeto que contiene la información del consentimiento para la iniciación del pago individual. Para los demás campos, sigue el estándar definido en la documentación oficial ([Open Finance - API Payment Initiation](https://openfinancebrasil.atlassian.net/wiki/spaces/OF/pages/17375943/SV+API+-+Pagamentos)).
          required:
            - callbackApplicationUri
          properties:
            callbackApplicationUri:
              type: string
              format: uri
              maxLength: 2000
              description: URI de callback de la aplicación después del proceso de autenticación
              example: "https://aplicativo.instituicao.com.br"
              pattern: '^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)$'
    EnumAccountPaymentsType:
      type: string
      maxLength: 4
      enum:
        - CACC
        - SLRY
        - SVGS
        - TRAN
      example: CACC
      description: |
        Tipos de cuentas utilizadas para pago vía Pix.
        Modalidades tradicionales previstas por la Resolución 4.753, no incluyendo:
        - cuentas vinculadas
        - cuentas de domiciliados en el exterior
        - cuentas en moneda extranjera
        - cuentas de moneda electrónica

        Significado de los valores del ENUM:
        CACC - Current - Cuenta corriente  
        SLRY - Salary - Cuenta salario  
        SVGS - Savings - Cuenta de ahorros  
        TRAN - TransactingAccount - Cuenta de pago prepaga
    EnumRole:
      type: string
      maxLength: 5
      enum:
        - DADOS
        - PAGTO
        - CONTA
        - CCORR
      example: CONTA
      description: |
        Rol regulador de la institución.
        Los tipos de roles están sujetos a cambios.
    UUID:
      format: uuid
      pattern: "[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}"
      type: string
      example: "556392bd-b4c2-4cc0-9abe-f2c77a5c5d8f"
    ResponseError:
      type: object
      required:
        - errors
      properties:
        errors:
          type: array
          minItems: 1
          maxItems: 13
          items:
            type: object
            required:
              - code
              - title
              - detail
            properties:
              code:
                description: Código de error específico del endpoint
                type: string
                pattern: '[\w\W\s]*'
                example: "4XX"
                maxLength: 255
              title:
                description: Título legible por humanos para este error específico
                type: string
                example: "Título legible por humanos de este error específico"
                pattern: '[\w\W\s]*'
                maxLength: 255
              detail:
                description: Descripción legible por humanos de este error específico
                type: string
                example: "Descripción legible por humanos de este error específico"
                pattern: '[\w\W\s]*'
                maxLength: 2048
            additionalProperties: false
        meta:
          $ref: "#/components/schemas/Meta"
      additionalProperties: false
  parameters:
    applicationId:
      name: x-application-id
      in: header
      required: true
      description: Identificador de la aplicación que realiza la solicitud
      schema:
        $ref: "#/components/schemas/UUID"
    authorisationServerId:
      name: x-authorisation-server-id
      required: true
      description: Identificador del Authorisation Server de la transmisora del consentimiento, obtenido a través de la consulta de la lista de participantes
      in: header
      schema:
        $ref: "#/components/schemas/UUID"
    headerConsentId:
      name: x-consent-id
      required: true
      in: header
      description: Identificador del consentimiento que se utilizará en esta operación, obtenido en la respuesta de su creación
      schema:
        type: string
        pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
        maxLength: 256
      example: "urn:bancox:f865cd66-392a-420b-9ff0-1b6d7cc60ee0"
    consentId:
      name: consentId
      required: true
      in: path
      description: |
        El consentId es el identificador único del consentimiento y deberá ser un URN - Uniform Resource Name.

        Un URN, conforme definido en la [RFC8141](https://tools.ietf.org/html/rfc8141),
        es un Uniform Resource Identifier (URI) asignado bajo el esquema "urn"
        y un namespace URN específico, con la intención de ser persistente e independiente de localización.

        Considerando la cadena urn:prudential:C1DD93123 como ejemplo de consentId, tenemos:
        - el namespace (urn)
        - el identificador asociado al namespace de la institución transmisora (bancox)
        - el identificador específico dentro del namespace (f865cd66-392a-420b-9ff0-1b6d7cc60ee0)

        Para más detalles sobre la construcción de namespaces, consultar la RFC8141.
      schema:
        type: string
        pattern: '^urn:[a-zA-Z0-9][a-zA-Z0-9-]{0,31}:[a-zA-Z0-9()+,\-.:=@;$_!*''%\/?#]+$'
        maxLength: 256
      example: "urn:bancox:f865cd66-392a-420b-9ff0-1b6d7cc60ee0"
